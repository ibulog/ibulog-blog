---
import type { CollectionEntry } from "astro:content";

import { render } from "astro:content";
import { Image } from "astro:assets";

import ArticleHeader from '../components/ui/ArticleHeader.astro';
import ArticleIndex from '../components/ArticleIndex.astro';
import ArticleCard from '../components/ArticleCard.astro';

type Props = {
  entry: CollectionEntry<'blog'>;
  prevArticle?: CollectionEntry<'blog'>;
  nextArticle?: CollectionEntry<'blog'>;
};

const { entry, prevArticle, nextArticle } = Astro.props;
const { title, pubDate, tags, heroImage } = entry.data;
const { headings } = await render(entry);
const { id } = entry;

---

<article class="flex flex-col gap-9">
  <ArticleHeader id={id} pubDate={pubDate} tags={tags} title={title} />
  {heroImage && (
    <div class="w-full rounded-xl overflow-hidden" transition:name={`hero-image-${id}`}>
      <Image width={1080} height={540} src={heroImage as any} alt={title} class="w-full h-auto" />
    </div>
  )}
  <ArticleIndex headings={headings} />
  <slot />
</article>
{(prevArticle || nextArticle) && (
  <div class="flex flex-col gap-6 pt-12 mt-12 border-t border-app-border-default-reverse">
    {nextArticle && (
      <div class="flex flex-col gap-2.5">
        <h3 class="text-base font-bold leading-none text-app-text">
          Next
        </h3>
        <ArticleCard entry={nextArticle} />
      </div>
    )}
    {prevArticle && (
      <div class="flex flex-col gap-2.5">
        <h3 class="text-base font-bold leading-none text-app-text">
          Previous
        </h3>
        <ArticleCard entry={prevArticle} />
      </div>
    )}
  </div>
)}
